{% extends "base.html" %}

{% csrf_token %}

{% block head %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'feed/css/feed.css' %}">
    <script src="{% static 'feed/js/async.js' %}"></script>
    <script src="{% static 'feed/js/interactionControls.js' %}"></script>
{% endblock %}


{% block content %}

{% for post, comments in posts %}
<div class="feed-post">
    <!-- Post's user information -->
    <div class="feed-post-userbadge">
        <img class="feed-post-userbadge-portrait" src="{{ post.author.get_portrait_url }}">

        <div>
            <div class="feed-post-userbadge-username">
                <a href="{% url 'feed:user_profile' post.author.id %}">{{ post.author.name }}</a>
                {% if post.author.is_verified %}
                <img class="feed-post-userbadge-verified" src="{% static 'feed/img/verified.png' %}" title="This user has a verified profile">
                {% endif %}
            </div>
            <div class="feed-post-userbadge-date">
                {{ post.create_date }}
            </div>
        </div>
    </div>

    <!-- Post content -->
    <div class="feed-post-content">
        {{ post.text }}
    </div>

    <!-- Post interaction controls -->
    <div class="feed-post-interaction-controls">
        <button class="feed-post-interaction-button feed-post-interaction-button-like" onclick="like('{{ post.id }}')">
            <span class="button-label">Like</span>
        </button>
        <button class="feed-post-interaction-button feed-post-interaction-button-comment" onclick="document.getElementById('comment-input-{{ post.id }}').focus()">
            <span class="button-label">Comment</span>
        </button>
        <button class="feed-post-interaction-button feed-post-interaction-button-share" onclick="share('{{ post.id }}')">
            <span class="button-label">Share</span>
        </button>
    </div>

    <div class="feed-post-interaction-separator"></div>
    <!-- Comment Section -->
    <div class="feed-post-comments">
        {% for comment in comments %}
        <div class="feed-post-comment">
            <div class="feed-post-comment-userbadge">
                <img class="feed-post-comment-userbadge-portrait" src="{{ comment.author.get_portrait_url }}">

                <div class="feed-post-comment-userbadge-username">
                    <a href="{% url 'feed:user_profile' comment.author.id %}">{{ comment.author.name }}</a>
                    {% if comment.author.is_verified %}
                    <img class="feed-post-comment-userbadge-verified" src="{% static 'feed/img/verified.png' %}" title="This user has a verified profile">
                    {% endif %}
                </div>
                <div class="feed-post-comment-userbadge-date">
                    {{ comment.create_date }}
                </div>
            </div>
            <div class="feed-post-comment-content">
                {{ comment.text }}
            </div>
            <div class="feed-post-comment-separator"></div>
        </div>
        {% endfor %}
        <!-- Comment writing section -->
        <div class="feed-post-comment-writing">
            <input class="feed-post-comment-text-box" id="comment-input-{{ post.id }}" type="text" placeholder="Say something!">
            <img class="feed-post-comment-text-box-button" src="{% static 'feed/img/arrow.png' %}" onclick="comment('{{ post.id }}', document.getElementById('comment-input-{{ post.id}}').value)">
        </div>
    </div>
</div>
{% endfor %}

{% endblock %}
